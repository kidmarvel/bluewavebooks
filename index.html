<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ“š BlueWave Bookstore - DEMO</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1E3A8A;
            --secondary: #3B82F6;
            --accent: #F59E0B;
            --bg: #F9FAFB;
        }
        * {
            font-family: 'Poppins', sans-serif;
        }
        .sidebar {
            background: var(--primary);
            color: white;
            min-height: 100vh;
            position: fixed;
            width: 250px;
            padding-top: 20px;
        }
        .main-content {
            margin-left: 250px;
            padding: 20px;
            background: var(--bg);
            min-height: 100vh;
        }
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        .btn-primary {
            background: var(--primary);
            border: none;
        }
        .btn-warning {
            background: var(--accent);
            border: none;
        }
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                min-height: auto;
                position: relative;
            }
            .main-content {
                margin-left: 0;
            }
        }
        .login-container {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .low-stock { background: #fee2e2 !important; }
        .out-of-stock { background: #fecaca !important; }
    </style>
</head>
<body>
    <!-- Login Page (Initial View) -->
    <div id="loginPage" class="login-container">
        <div class="card" style="width: 400px;">
            <div class="card-header bg-primary text-white text-center py-4">
                <h2><i class="bi bi-book"></i> BlueWave Bookstore</h2>
                <p class="mb-0">Information System DEMO</p>
            </div>
            <div class="card-body p-4">
                <div class="mb-3">
                    <label class="form-label">Username</label>
                    <select id="username" class="form-select">
                        <option value="admin">Admin User</option>
                        <option value="cashier">Cashier User</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label class="form-label">Password</label>
                    <input type="password" id="password" class="form-control" value="password123" readonly>
                </div>
                <button onclick="login()" class="btn btn-primary w-100">
                    <i class="bi bi-box-arrow-in-right"></i> Login
                </button>
                <div class="alert alert-info mt-3 mb-0">
                    <small>
                        <strong>Demo Notice:</strong> This is a static simulation. 
                        Data is stored in browser memory only.
                    </small>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App (Hidden Initially) -->
    <div id="app" style="display: none;">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="text-center p-3">
                <h4><i class="bi bi-book"></i> BBIS</h4>
                <small>Demo Mode</small>
            </div>
            <div class="nav flex-column">
                <a href="#" class="nav-link text-white" onclick="showPage('dashboard')">
                    <i class="bi bi-speedometer2"></i> Dashboard
                </a>
                <a href="#" class="nav-link text-white" onclick="showPage('books')">
                    <i class="bi bi-book"></i> Books
                </a>
                <a href="#" class="nav-link text-white" onclick="showPage('sales')">
                    <i class="bi bi-cart"></i> Sales
                </a>
                <a href="#" class="nav-link text-white" onclick="showPage('inventory')">
                    <i class="bi bi-box-seam"></i> Inventory
                </a>
                <a href="#" class="nav-link text-white" onclick="showPage('suppliers')">
                    <i class="bi bi-truck"></i> Suppliers
                </a>
                <a href="#" class="nav-link text-white" onclick="showPage('reports')">
                    <i class="bi bi-graph-up"></i> Reports
                </a>
                <a href="#" class="nav-link text-white" onclick="logout()">
                    <i class="bi bi-box-arrow-right"></i> Logout
                </a>
            </div>
            <div class="position-absolute bottom-0 start-0 p-3 w-100">
                <small class="text-white-50">
                    User: <span id="currentUser">admin</span>
                </small>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard Page -->
            <div id="dashboardPage" class="page">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="bi bi-speedometer2"></i> Dashboard</h2>
                    <button class="btn btn-warning" onclick="resetDemo()">
                        <i class="bi bi-arrow-clockwise"></i> Reset Demo Data
                    </button>
                </div>
                
                <!-- Stats Cards -->
                <div class="row g-4 mb-4">
                    <div class="col-md-3 col-6">
                        <div class="card p-4 text-center">
                            <i class="bi bi-book text-primary fs-1"></i>
                            <h3 class="mt-3" id="totalBooks">0</h3>
                            <p class="text-muted mb-0">Total Books</p>
                        </div>
                    </div>
                    <div class="col-md-3 col-6">
                        <div class="card p-4 text-center">
                            <i class="bi bi-currency-dollar text-success fs-1"></i>
                            <h3 class="mt-3">$<span id="todaySales">0.00</span></h3>
                            <p class="text-muted mb-0">Today's Sales</p>
                        </div>
                    </div>
                    <div class="col-md-3 col-6">
                        <div class="card p-4 text-center">
                            <i class="bi bi-exclamation-triangle text-warning fs-1"></i>
                            <h3 class="mt-3" id="lowStockCount">0</h3>
                            <p class="text-muted mb-0">Low Stock Alerts</p>
                        </div>
                    </div>
                    <div class="col-md-3 col-6">
                        <div class="card p-4 text-center">
                            <i class="bi bi-truck text-info fs-1"></i>
                            <h3 class="mt-3" id="totalSuppliers">0</h3>
                            <p class="text-muted mb-0">Suppliers</p>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Recent Sales</h5>
                            </div>
                            <div class="card-body">
                                <div id="recentSales" class="table-responsive">
                                    <!-- Filled by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Low Stock Books</h5>
                            </div>
                            <div class="card-body">
                                <div id="lowStockList" class="table-responsive">
                                    <!-- Filled by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Books Management Page -->
            <div id="booksPage" class="page" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="bi bi-book"></i> Books Management</h2>
                    <button class="btn btn-primary" onclick="showBookModal()">
                        <i class="bi bi-plus-circle"></i> Add Book
                    </button>
                </div>

                <div class="card">
                    <div class="card-body">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <input type="text" id="bookSearch" class="form-control" 
                                       placeholder="Search books..." onkeyup="filterBooks()">
                            </div>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Title</th>
                                        <th>Author</th>
                                        <th>Price</th>
                                        <th>Stock</th>
                                        <th>Category</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="booksTable">
                                    <!-- Filled by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sales Page -->
            <div id="salesPage" class="page" style="display: none;">
                <h2 class="mb-4"><i class="bi bi-cart"></i> Sales Processing</h2>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div class="card-header bg-primary text-white">
                                <h5 class="mb-0">New Sale</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Select Book</label>
                                    <select id="saleBookSelect" class="form-select" onchange="updateSalePrice()">
                                        <!-- Filled by JavaScript -->
                                    </select>
                                </div>
                                <div class="row mb-3">
                                    <div class="col">
                                        <label class="form-label">Unit Price</label>
                                        <input type="text" id="saleUnitPrice" class="form-control" readonly>
                                    </div>
                                    <div class="col">
                                        <label class="form-label">Available Stock</label>
                                        <input type="text" id="saleStock" class="form-control" readonly>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Quantity</label>
                                    <input type="number" id="saleQuantity" class="form-control" 
                                           min="1" value="1" oninput="updateSaleTotal()">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Total Amount</label>
                                    <input type="text" id="saleTotal" class="form-control fs-4 fw-bold text-success" readonly>
                                </div>
                                <button onclick="processSale()" class="btn btn-primary w-100">
                                    <i class="bi bi-check-circle"></i> Process Sale
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Today's Sales</h5>
                            </div>
                            <div class="card-body">
                                <div id="todaySalesList" class="table-responsive">
                                    <!-- Filled by JavaScript -->
                                </div>
                                <div class="mt-3 p-2 bg-light rounded">
                                    <strong>Total Today: $<span id="todayTotal">0.00</span></strong>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Inventory Page -->
            <div id="inventoryPage" class="page" style="display: none;">
                <h2 class="mb-4"><i class="bi bi-box-seam"></i> Inventory Management</h2>
                
                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Book</th>
                                        <th>Current Stock</th>
                                        <th>Status</th>
                                        <th>Last Sold</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody id="inventoryTable">
                                    <!-- Filled by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reports Page -->
            <div id="reportsPage" class="page" style="display: none;">
                <h2 class="mb-4"><i class="bi bi-graph-up"></i> Reports</h2>
                
                <div class="card mb-4">
                    <div class="card-body">
                        <h5>Sales Report</h5>
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Book</th>
                                        <th>Quantity</th>
                                        <th>Amount</th>
                                    </tr>
                                </thead>
                                <tbody id="salesReport">
                                    <!-- Filled by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        <button onclick="exportData()" class="btn btn-outline-primary mt-2">
                            <i class="bi bi-download"></i> Export as CSV
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Book Modal -->
    <div class="modal fade" id="bookModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalTitle">Add New Book</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="editBookId">
                    <div class="mb-3">
                        <label class="form-label">Title *</label>
                        <input type="text" id="bookTitle" class="form-control" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Author *</label>
                        <input type="text" id="bookAuthor" class="form-control" required>
                    </div>
                    <div class="row mb-3">
                        <div class="col">
                            <label class="form-label">Price *</label>
                            <input type="number" id="bookPrice" class="form-control" step="0.01" required>
                        </div>
                        <div class="col">
                            <label class="form-label">Quantity *</label>
                            <input type="number" id="bookQuantity" class="form-control" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Category</label>
                        <select id="bookCategory" class="form-select">
                            <option value="Fiction">Fiction</option>
                            <option value="Technology">Technology</option>
                            <option value="Business">Business</option>
                            <option value="Science">Science</option>
                            <option value="Education">Education</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveBook()">Save Book</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Restock Modal -->
    <div class="modal fade" id="restockModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Restock Book</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="restockBookId">
                    <p>Book: <strong id="restockBookTitle"></strong></p>
                    <div class="mb-3">
                        <label class="form-label">Quantity to Add</label>
                        <input type="number" id="restockQuantity" class="form-control" min="1" value="10">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="restockBook()">Restock</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // ================= DATA STORAGE =================
        let demoData = {
            books: [],
            sales: [],
            suppliers: [
                { id: 1, name: "Book Distributors Inc", categories: "Fiction, Business" },
                { id: 2, name: "Global Publishers Ltd", categories: "Technology, Science" }
            ]
        };

        // Load data from localStorage or initialize
        function loadData() {
            const saved = localStorage.getItem('bluewave_demo');
            if (saved) {
                demoData = JSON.parse(saved);
            } else {
                // Initial demo data
                demoData.books = [
                    { id: 1, title: "The Great Gatsby", author: "F. Scott Fitzgerald", 
                      price: 12.99, quantity: 25, category: "Fiction", sales: 5 },
                    { id: 2, title: "Introduction to Algorithms", author: "Thomas H. Cormen", 
                      price: 89.99, quantity: 15, category: "Technology", sales: 3 },
                    { id: 3, title: "The Lean Startup", author: "Eric Ries", 
                      price: 24.99, quantity: 8, category: "Business", sales: 7 },
                    { id: 4, title: "Clean Code", author: "Robert C. Martin", 
                      price: 45.99, quantity: 12, category: "Technology", sales: 4 },
                    { id: 5, title: "To Kill a Mockingbird", author: "Harper Lee", 
                      price: 14.99, quantity: 2, category: "Fiction", sales: 6 }
                ];
                
                // Generate some sales history
                const today = new Date().toISOString().split('T')[0];
                demoData.sales = [
                    { id: 1, bookId: 1, title: "The Great Gatsby", quantity: 1, 
                      total: 12.99, date: today, time: "10:30 AM" },
                    { id: 2, bookId: 3, title: "The Lean Startup", quantity: 2, 
                      total: 49.98, date: today, time: "11:45 AM" }
                ];
                
                saveData();
            }
        }

        function saveData() {
            localStorage.setItem('bluewave_demo', JSON.stringify(demoData));
        }

        // ================= AUTHENTICATION =================
        function login() {
            const username = document.getElementById('username').value;
            document.getElementById('currentUser').textContent = username;
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('app').style.display = 'block';
            loadData();
            showPage('dashboard');
            updateDashboard();
        }

        function logout() {
            if (confirm('Logout from demo?')) {
                document.getElementById('app').style.display = 'none';
                document.getElementById('loginPage').style.display = 'flex';
            }
        }

        function resetDemo() {
            if (confirm('Reset all demo data to initial state?')) {
                localStorage.removeItem('bluewave_demo');
                loadData();
                updateDashboard();
                showPage('dashboard');
                alert('Demo data reset successfully!');
            }
        }

        // ================= PAGE NAVIGATION =================
        function showPage(pageName) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.style.display = 'none';
            });
            
            // Show selected page
            document.getElementById(pageName + 'Page').style.display = 'block';
            
            // Update page content
            switch(pageName) {
                case 'dashboard':
                    updateDashboard();
                    break;
                case 'books':
                    renderBooksTable();
                    break;
                case 'sales':
                    updateSalesPage();
                    break;
                case 'inventory':
                    renderInventoryTable();
                    break;
                case 'reports':
                    renderReports();
                    break;
            }
        }

        // ================= DASHBOARD =================
        function updateDashboard() {
            // Calculate stats
            const totalBooks = demoData.books.length;
            const lowStock = demoData.books.filter(b => b.quantity < 10).length;
            const today = new Date().toISOString().split('T')[0];
            const todaySales = demoData.sales
                .filter(s => s.date === today)
                .reduce((sum, sale) => sum + sale.total, 0);
            
            // Update numbers
            document.getElementById('totalBooks').textContent = totalBooks;
            document.getElementById('lowStockCount').textContent = lowStock;
            document.getElementById('todaySales').textContent = todaySales.toFixed(2);
            document.getElementById('totalSuppliers').textContent = demoData.suppliers.length;
            
            // Update recent sales table
            const recentSales = demoData.sales.slice(-5).reverse();
            document.getElementById('recentSales').innerHTML = `
                <table class="table table-sm">
                    <thead>
                        <tr><th>Book</th><th>Qty</th><th>Amount</th><th>Time</th></tr>
                    </thead>
                    <tbody>
                        ${recentSales.map(sale => `
                            <tr>
                                <td>${sale.title}</td>
                                <td>${sale.quantity}</td>
                                <td>$${sale.total.toFixed(2)}</td>
                                <td>${sale.time}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            
            // Update low stock list
            const lowStockBooks = demoData.books.filter(b => b.quantity < 10);
            document.getElementById('lowStockList').innerHTML = `
                <table class="table table-sm">
                    <thead>
                        <tr><th>Book</th><th>Stock</th><th>Status</th></tr>
                    </thead>
                    <tbody>
                        ${lowStockBooks.map(book => `
                            <tr class="${book.quantity < 5 ? 'table-warning' : ''}">
                                <td>${book.title}</td>
                                <td>${book.quantity}</td>
                                <td>
                                    <span class="badge ${book.quantity < 5 ? 'bg-danger' : 'bg-warning'}">
                                        ${book.quantity < 5 ? 'Critical' : 'Low'}
                                    </span>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        // ================= BOOKS MANAGEMENT =================
        function renderBooksTable() {
            const booksTable = document.getElementById('booksTable');
            booksTable.innerHTML = demoData.books.map(book => `
                <tr class="${book.quantity < 5 ? 'low-stock' : book.quantity < 10 ? 'table-warning' : ''}">
                    <td>${book.title}</td>
                    <td>${book.author}</td>
                    <td>$${book.price.toFixed(2)}</td>
                    <td>
                        <span class="${book.quantity < 10 ? 'fw-bold' : ''}">
                            ${book.quantity}
                            ${book.quantity < 5 ? '<i class="bi bi-exclamation-triangle text-danger"></i>' : ''}
                        </span>
                    </td>
                    <td><span class="badge bg-secondary">${book.category}</span></td>
                    <td>
                        <button class="btn btn-sm btn-warning" onclick="editBook(${book.id})">
                            <i class="bi bi-pencil"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="deleteBook(${book.id})">
                            <i class="bi bi-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function filterBooks() {
            const search = document.getElementById('bookSearch').value.toLowerCase();
            const rows = document.querySelectorAll('#booksTable tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(search) ? '' : 'none';
            });
        }

        function showBookModal(bookId = null) {
            const modal = new bootstrap.Modal(document.getElementById('bookModal'));
            const title = document.getElementById('modalTitle');
            const idField = document.getElementById('editBookId');
            
            if (bookId) {
                // Edit mode
                const book = demoData.books.find(b => b.id === bookId);
                title.textContent = 'Edit Book';
                idField.value = bookId;
                document.getElementById('bookTitle').value = book.title;
                document.getElementById('bookAuthor').value = book.author;
                document.getElementById('bookPrice').value = book.price;
                document.getElementById('bookQuantity').value = book.quantity;
                document.getElementById('bookCategory').value = book.category;
            } else {
                // Add mode
                title.textContent = 'Add New Book';
                idField.value = '';
                document.getElementById('bookTitle').value = '';
                document.getElementById('bookAuthor').value = '';
                document.getElementById('bookPrice').value = '';
                document.getElementById('bookQuantity').value = '';
                document.getElementById('bookCategory').value = 'Fiction';
            }
            
            modal.show();
        }

        function saveBook() {
            const id = document.getElementById('editBookId').value;
            const title = document.getElementById('bookTitle').value;
            const author = document.getElementById('bookAuthor').value;
            const price = parseFloat(document.getElementById('bookPrice').value);
            const quantity = parseInt(document.getElementById('bookQuantity').value);
            const category = document.getElementById('bookCategory').value;
            
            if (!title || !author || !price || !quantity) {
                alert('Please fill all required fields');
                return;
            }
            
            if (id) {
                // Update existing book
                const book = demoData.books.find(b => b.id === parseInt(id));
                Object.assign(book, { title, author, price, quantity, category });
            } else {
                // Add new book
                const newId = demoData.books.length > 0 ? 
                    Math.max(...demoData.books.map(b => b.id)) + 1 : 1;
                demoData.books.push({
                    id: newId,
                    title,
                    author,
                    price,
                    quantity,
                    category,
                    sales: 0
                });
            }
            
            saveData();
            renderBooksTable();
            updateDashboard();
            bootstrap.Modal.getInstance(document.getElementById('bookModal')).hide();
            
            alert(id ? 'Book updated successfully!' : 'Book added successfully!');
        }

        function editBook(id) {
            showBookModal(id);
        }

        function deleteBook(id) {
            if (confirm('Delete this book?')) {
                demoData.books = demoData.books.filter(b => b.id !== id);
                saveData();
                renderBooksTable();
                updateDashboard();
                alert('Book deleted!');
            }
        }

        // ================= SALES =================
        function updateSalesPage() {
            // Update book dropdown
            const select = document.getElementById('saleBookSelect');
            select.innerHTML = '<option value="">Select a book...</option>' +
                demoData.books.map(book => `
                    <option value="${book.id}" 
                            data-price="${book.price}" 
                            data-stock="${book.quantity}">
                        ${book.title} - $${book.price.toFixed(2)} (Stock: ${book.quantity})
                    </option>
                `).join('');
            
            updateSalePrice();
            renderTodaySales();
        }

        function updateSalePrice() {
            const select = document.getElementById('saleBookSelect');
            const selected = select.options[select.selectedIndex];
            
            if (selected && selected.value) {
                const price = parseFloat(selected.getAttribute('data-price'));
                const stock = parseInt(selected.getAttribute('data-stock'));
                document.getElementById('saleUnitPrice').value = `$${price.toFixed(2)}`;
                document.getElementById('saleStock').value = stock;
                document.getElementById('saleQuantity').max = stock;
            } else {
                document.getElementById('saleUnitPrice').value = '';
                document.getElementById('saleStock').value = '';
            }
            
            updateSaleTotal();
        }

        function updateSaleTotal() {
            const price = parseFloat(document.getElementById('saleUnitPrice').value.replace('$', '')) || 0;
            const quantity = parseInt(document.getElementById('saleQuantity').value) || 0;
            const total = price * quantity;
            document.getElementById('saleTotal').value = total ? `$${total.toFixed(2)}` : '';
        }

        function processSale() {
            const bookId = parseInt(document.getElementById('saleBookSelect').value);
            const quantity = parseInt(document.getElementById('saleQuantity').value);
            
            if (!bookId || !quantity) {
                alert('Please select a book and quantity');
                return;
            }
            
            const book = demoData.books.find(b => b.id === bookId);
            if (book.quantity < quantity) {
                alert(`Only ${book.quantity} units available!`);
                return;
            }
            
            // Update book quantity
            book.quantity -= quantity;
            book.sales = (book.sales || 0) + quantity;
            
            // Record sale
            const now = new Date();
            const saleId = demoData.sales.length > 0 ? 
                Math.max(...demoData.sales.map(s => s.id)) + 1 : 1;
            
            demoData.sales.push({
                id: saleId,
                bookId,
                title: book.title,
                quantity,
                total: book.price * quantity,
                date: now.toISOString().split('T')[0],
                time: now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
            });
            
            saveData();
            updateDashboard();
            updateSalesPage();
            
            // Show receipt
            alert(`âœ… Sale processed!\n\nBook: ${book.title}\nQuantity: ${quantity}\nTotal: $${(book.price * quantity).toFixed(2)}\n\nNew stock: ${book.quantity}`);
            
            // Reset form
            document.getElementById('saleQuantity').value = 1;
            updateSaleTotal();
        }

        function renderTodaySales() {
            const today = new Date().toISOString().split('T')[0];
            const todaySales = demoData.sales.filter(s => s.date === today);
            const total = todaySales.reduce((sum, sale) => sum + sale.total, 0);
            
            document.getElementById('todaySalesList').innerHTML = `
                <table class="table table-sm">
                    <thead>
                        <tr><th>Book</th><th>Qty</th><th>Amount</th><th>Time</th></tr>
                    </thead>
                    <tbody>
                        ${todaySales.map(sale => `
                            <tr>
                                <td>${sale.title}</td>
                                <td>${sale.quantity}</td>
                                <td>$${sale.total.toFixed(2)}</td>
                                <td>${sale.time}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            
            document.getElementById('todayTotal').textContent = total.toFixed(2);
        }

        // ================= INVENTORY =================
        function renderInventoryTable() {
            const tbody = document.getElementById('inventoryTable');
            tbody.innerHTML = demoData.books.map(book => {
                let statusClass = 'bg-success';
                let statusText = 'Good';
                
                if (book.quantity === 0) {
                    statusClass = 'bg-danger';
                    statusText = 'Out of Stock';
                } else if (book.quantity < 5) {
                    statusClass = 'bg-danger';
                    statusText = 'Critical';
                } else if (book.quantity < 10) {
                    statusClass = 'bg-warning';
                    statusText = 'Low';
                }
                
                // Find last sale time
                const lastSale = demoData.sales
                    .filter(s => s.bookId === book.id)
                    .sort((a, b) => new Date(b.date + ' ' + b.time) - new Date(a.date + ' ' + a.time))[0];
                
                return `
                    <tr class="${book.quantity < 5 ? 'low-stock' : ''}">
                        <td>${book.title}</td>
                        <td class="fw-bold">${book.quantity}</td>
                        <td><span class="badge ${statusClass}">${statusText}</span></td>
                        <td>${lastSale ? lastSale.time + ' ' + lastSale.date : 'Never'}</td>
                        <td>
                            <button class="btn btn-sm btn-primary" onclick="showRestockModal(${book.id})">
                                <i class="bi bi-box-arrow-in-down"></i> Restock
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function showRestockModal(bookId) {
            const book = demoData.books.find(b => b.id === bookId);
            document.getElementById('restockBookId').value = bookId;
            document.getElementById('restockBookTitle').textContent = book.title;
            
            const modal = new bootstrap.Modal(document.getElementById('restockModal'));
            modal.show();
        }

        function restockBook() {
            const bookId = parseInt(document.getElementById('restockBookId').value);
            const quantity = parseInt(document.getElementById('restockQuantity').value);
            
            const book = demoData.books.find(b => b.id === bookId);
            book.quantity += quantity;
            
            saveData();
            renderInventoryTable();
            updateDashboard();
            
            bootstrap.Modal.getInstance(document.getElementById('restockModal')).hide();
            alert(`Added ${quantity} units to ${book.title}\nNew total: ${book.quantity}`);
        }

        // ================= REPORTS =================
        function renderReports() {
            // Group sales by date
            const salesByDate = {};
            demoData.sales.forEach(sale => {
                if (!salesByDate[sale.date]) {
                    salesByDate[sale.date] = [];
                }
                salesByDate[sale.date].push(sale);
            });
            
            // Create report rows
            let rows = [];
            Object.keys(salesByDate).sort().reverse().forEach(date => {
                const dateSales = salesByDate[date];
                dateSales.forEach(sale => {
                    rows.push(`
                        <tr>
                            <td>${date}</td>
                            <td>${sale.title}</td>
                            <td>${sale.quantity}</td>
                            <td>$${sale.total.toFixed(2)}</td>
                        </tr>
                    `);
                });
            });
            
            document.getElementById('salesReport').innerHTML = rows.join('');
        }

        function exportData() {
            // Create CSV content
            let csv = 'Date,Book,Quantity,Amount\n';
            demoData.sales.forEach(sale => {
                csv += `${sale.date},${sale.title},${sale.quantity},${sale.total}\n`;
            });
            
            // Create download link
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'bluewave_sales_report.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            alert('CSV file downloaded!');
        }

        // ================= INITIALIZATION =================
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Bootstrap modals
            const bookModal = new bootstrap.Modal(document.getElementById('bookModal'));
            const restockModal = new bootstrap.Modal(document.getElementById('restockModal'));
            
            // Load initial data
            loadData();
            
            // Demo instructions
            console.log('ðŸ“š BlueWave Bookstore DEMO Loaded!');
            console.log('- Login: admin / password123');
            console.log('- Data stored in localStorage');
            console.log('- Reset demo: Dashboard â†’ Reset Demo Data');
        });
    </script>
</body>
</html>
